knitr::opts_chunk$set(echo = TRUE)
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)], scale)
knitr::opts_chunk$set(echo = TRUE)
install.packages("FNN")
install.packages("corrplot")
install.packages("tree")
install.packages("caret")
install.packages("ggplot2")
library(tidyverse)
library(FNN)
library(corrplot)
library(tree)
library(caret)
library(ggplot2)
options(warn=1)
Vgsales <- read.csv("./archive/Video_Games_Sales_as_at_22_Dec_2016.csv", sep=",", na.strings = c(""," ","NA", "N/A"))
head(Vgsales)
str(Vgsales)
na_count <-  sapply(Vgsales, function(y) sum(is.na(y)))
na_count <-  data.frame(na_count)
na_count
#  drop all NA values
Vgsales <- na.omit(Vgsales)
str(Vgsales)
#  drop all sales except global
Vgsales_df <- cbind(Vgsales[,-c(6:10)], Vgsales$Global_Sales)
Vgsales_df$Year_of_Release <-  2016 - Vgsales_df$Year_of_Release
names(Vgsales_df)[3] <- "Game_Age"
names(Vgsales_df)[12] <- "Global_Sales"
str(Vgsales_df)
summary(Vgsales_df)
fig <- function(width, height){
options(repr.plot.width = width, repr.plot.height = height)
}
fig(20,8)
Platform_bar <- ggplot(Vgsales_df, aes(x=Platform, fill=Platform)) + geom_bar()
Platform_bar
fig(15,8)
Age_bar <- ggplot(Vgsales_df, aes(x=Game_Age)) + geom_bar(fill="forestgreen")
Age_bar
fig(50,8)
Genre_bar <- ggplot(Vgsales_df, aes(x=Genre, fill = Genre)) + geom_bar() + theme(axis.text.x=element_text(angle=90, vjust=.5, hjust=1))
Genre_bar
fig(30,8)
Critic_Score_hist <- ggplot(Vgsales_df, aes(Critic_Score)) + geom_histogram(binwidth=4,color="black", fill="blue")
Critic_Score_hist
Critic_Count_hist <- ggplot(Vgsales_df, aes(Critic_Count)) + geom_histogram(binwidth = 4, color="black", fill="skyblue")
Critic_Count_hist
fig(30,8)
Vgsales_df %>% select(Name, User_Score) %>% arrange(desc(User_Score)) %>% head(10) %>%
ggplot(aes(x=Name, y=User_Score, fill = Name)) + geom_bar(stat="identity") + theme(axis.text.x =element_text(angle=90, vjust=.5,hjust=1))
fig(20, 8)
User_Count_hist <- ggplot(Vgsales_df, aes(User_Count)) + geom_histogram(color="black", fill="skyblue")
User_Count_hist
summary(Vgsales_df$User_Count)
Rating_bar = ggplot(Vgsales_df, aes(x=Rating, fill=Rating)) + geom_bar()
Rating_bar
fig(20,8)
sales_by_platform <- ggplot(Vgsales_df, aes(Platform, Global_Sales, fill = Platform)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle=90, vjust = .5, hjust = 1)) + labs(x="Platform", y="Global_Series", title="Sales by Platform")
sales_by_platform
Vgsales_df %>% select(Publisher, Global_Sales) %>% group_by(Publisher) %>% summarise(Total_sales=sum(Global_Sales)) %>% arrange(desc(Total_sales)) %>%  head(10) %>% ggplot(aes(x=Publisher, y=Total_sales, fill=Publisher)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle = 90, hjust = 1, vjust = .5, size=10)) + labs(x="Developer", y="Global Sales", title="Top 10 selling Developers")
summary(Vgsales_df)
str(Vgsales_df)
Vgsales_df %>% select(Name, Global_Sales) %>% arrange(desc(Global_Sales)) %>% head(10) %>% ggplot(aes(x=Name, y = Global_Sales, fill = Name)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle = 90,vjust = .5, hjust = 1)) + labs(x="Game", y="Global sales", title = "Top 10 best selling games")
ggplot(Vgsales_df, aes(Game_Age, Global_Sales)) + geom_jitter(color="darkviolet")
ggplot(Vgsales_df, aes(Critic_Score, Global_Sales)) + geom_jitter(color="darkblue")
ggplot(Vgsales_df, aes(Critic_Count, Global_Sales)) + geom_jitter(color="red")
ggplot(Vgsales_df, aes(User_Count, Global_Sales)) + geom_jitter(color="orange")
# Name column is an id column we can remove for good (only user for games Top 10 sales)
Vgsales_df <-  Vgsales_df[,-1]
knn.df <- Vgsales_df
head(knn.df)
# Any non_numeric number coerced into a NA
for (i in 1:dim(knn.df)[2]) {
knn.df[,i] <- as.numeric(knn.df[,i])
}
head(knn.df)
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)], scale)
knn.df1 <- as.data.frame(knn.df1)
knn.df <- cbind(knn.df1, knn.df$Global_Sales)
names(knn.df1)[11] = "Global_Sales"
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)],scale)
knn.df1 <- as.data.frame(knn.df1)
knn.df <- cbind(knn.df1,knn.df$Global_Sales)
knitr::opts_chunk$set(echo = TRUE)
install.packages("FNN")
install.packages("corrplot")
install.packages("tree")
install.packages("caret")
install.packages("ggplot2")
library(tidyverse)
library(FNN)
library(corrplot)
library(tree)
library(caret)
library(ggplot2)
options(warn=1)
Vgsales <- read.csv("./archive/Video_Games_Sales_as_at_22_Dec_2016.csv", sep=",", na.strings = c(""," ","NA", "N/A"))
head(Vgsales)
str(Vgsales)
na_count <-  sapply(Vgsales, function(y) sum(is.na(y)))
na_count <-  data.frame(na_count)
na_count
#  drop all NA values
Vgsales <- na.omit(Vgsales)
str(Vgsales)
#  drop all sales except global
Vgsales_df <- cbind(Vgsales[,-c(6:10)], Vgsales$Global_Sales)
Vgsales_df$Year_of_Release <-  2016 - Vgsales_df$Year_of_Release
names(Vgsales_df)[3] <- "Game_Age"
names(Vgsales_df)[12] <- "Global_Sales"
str(Vgsales_df)
summary(Vgsales_df)
fig <- function(width, height){
options(repr.plot.width = width, repr.plot.height = height)
}
fig(20,8)
Platform_bar <- ggplot(Vgsales_df, aes(x=Platform, fill=Platform)) + geom_bar()
Platform_bar
fig(15,8)
Age_bar <- ggplot(Vgsales_df, aes(x=Game_Age)) + geom_bar(fill="forestgreen")
Age_bar
fig(50,8)
Genre_bar <- ggplot(Vgsales_df, aes(x=Genre, fill = Genre)) + geom_bar() + theme(axis.text.x=element_text(angle=90, vjust=.5, hjust=1))
Genre_bar
fig(30,8)
Critic_Score_hist <- ggplot(Vgsales_df, aes(Critic_Score)) + geom_histogram(binwidth=4,color="black", fill="blue")
Critic_Score_hist
Critic_Count_hist <- ggplot(Vgsales_df, aes(Critic_Count)) + geom_histogram(binwidth = 4, color="black", fill="skyblue")
Critic_Count_hist
fig(30,8)
Vgsales_df %>% select(Name, User_Score) %>% arrange(desc(User_Score)) %>% head(10) %>%
ggplot(aes(x=Name, y=User_Score, fill = Name)) + geom_bar(stat="identity") + theme(axis.text.x =element_text(angle=90, vjust=.5,hjust=1))
fig(20, 8)
User_Count_hist <- ggplot(Vgsales_df, aes(User_Count)) + geom_histogram(color="black", fill="skyblue")
User_Count_hist
summary(Vgsales_df$User_Count)
Rating_bar = ggplot(Vgsales_df, aes(x=Rating, fill=Rating)) + geom_bar()
Rating_bar
fig(20,8)
sales_by_platform <- ggplot(Vgsales_df, aes(Platform, Global_Sales, fill = Platform)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle=90, vjust = .5, hjust = 1)) + labs(x="Platform", y="Global_Series", title="Sales by Platform")
sales_by_platform
install.packages("ggplot2")
install.packages("caret")
install.packages("tree")
Vgsales_df %>% select(Publisher, Global_Sales) %>% group_by(Publisher) %>% summarise(Total_sales=sum(Global_Sales)) %>% arrange(desc(Total_sales)) %>%  head(10) %>% ggplot(aes(x=Publisher, y=Total_sales, fill=Publisher)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle = 90, hjust = 1, vjust = .5, size=10)) + labs(x="Developer", y="Global Sales", title="Top 10 selling Developers")
install.packages("corrplot")
install.packages("FNN")
summary(Vgsales_df)
str(Vgsales_df)
Vgsales_df %>% select(Name, Global_Sales) %>% arrange(desc(Global_Sales)) %>% head(10) %>% ggplot(aes(x=Name, y = Global_Sales, fill = Name)) + geom_bar(stat="identity") + theme(axis.text.x=element_text(angle = 90,vjust = .5, hjust = 1)) + labs(x="Game", y="Global sales", title = "Top 10 best selling games")
ggplot(Vgsales_df, aes(Game_Age, Global_Sales)) + geom_jitter(color="darkviolet")
ggplot(Vgsales_df, aes(Critic_Score, Global_Sales)) + geom_jitter(color="darkblue")
ggplot(Vgsales_df, aes(Critic_Count, Global_Sales)) + geom_jitter(color="red")
ggplot(Vgsales_df, aes(User_Count, Global_Sales)) + geom_jitter(color="orange")
# Name column is an id column we can remove for good (only user for games Top 10 sales)
Vgsales_df <-  Vgsales_df[,-1]
knn.df <- Vgsales_df
head(knn.df)
# Any non_numeric number coerced into a NA
for (i in 1:dim(knn.df)[2]) {
knn.df[,i] <- as.numeric(knn.df[,i])
}
head(knn.df)
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)],scale)
knn.df1 <- as.data.frame(knn.df1)
knn.df <- cbind(knn.df1,knn.df$Global_Sales)
names(knn.df)[11] = "Global_Sales"
head(knn.df)
install.packages("FNN")
install.packages("corrplot")
install.packages("tree")
install.packages("tree")
knn.df1 <- sapply(knn.ddf[,1:(dim(knn.df)[2]-1)], scale)
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)], scale)
knn.df1 <- sapply(knn.df[,1:(dim(knn.df)[2]-1)], scale)
knn.df1 <- as.data.frame(knn.df1)
knn.df <- cbind(knn.df1, knn.df$Global_Sales)
names(knn.df)[11] = "Global_Sales"
head(knn.df)
set.seed(5)
set.seed(5)
train.size <- floor(.7*nrow(knn.df))
set.seed(5)
train.size <- floor(.7*nrow(knn.df))
